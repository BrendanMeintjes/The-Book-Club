<% layout('layouts/boilerplate')%>
    <link rel="stylesheet" href="/stylesheets/rating.css">
    <div class="text-end mb-2">
        <a href="/home" onclick="backToClubs()" class="btn secondaryBtn"><i class="bi bi-arrow-90deg-left"></i> Back To Bookclubs</a>
        <% if( currentUser && club.admin.equals(currentUser._id)) { %>
            <!-- Button trigger modal -->
            <button type="button" class="btn secondaryBtn" data-bs-toggle="modal" data-bs-target="#editClub">
                <i class="bi bi-pencil-square"></i> Edit </button>
            <!-- Modal -->
            <div class="modal fade text-start" id="editClub" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="editClubLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content club">
                        <div class="modal-header">
                            <h1 class="modal-title" id="editClubLabel">Edit Book Club</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form action="/bookclubs/<%= club._id%>?_method=PUT" method="POST">
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label" for="name">Name</label>
                                    <input class="form-control club" type="text" id="name" name="club[name]" value="<%= club.name%>">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label" for="description">Description</label>
                                    <input class="form-control club" type="text" id="description" name="club[description]" value="<%= club.description%>">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn secondaryBtn active">Confirm</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Button trigger modal -->
            <button type="button" class="btn primaryBtn" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                <i class="bi bi-trash3"></i> Delete </button>
            <!-- Modal -->
            <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content club">
                        <div class="modal-header">
                            <h1 class="modal-title" id="staticBackdropLabel">Delete Bookclub</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-start"> Are you sure you want to delete this bookclub? </div>
                        <div class="modal-footer">
                            <form class="d-inline" action="/bookclubs/<%= club._id%>?_method=DELETE" method="POST">
                                <button class="btn primaryBtn active"><i class="bi bi-trash3"></i> Delete</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <% } %>
                <% if( club.members.includes(currentUser._id)) { %>
                    <button type="button" class="btn primaryBtn" data-bs-toggle="modal" data-bs-target="#leaveClub">
                        <i class="bi bi-trash3"></i> Leave Club </button>
                    <!-- Modal -->
                    <div class="modal fade" id="leaveClub" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="leaveClubLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content club">
                                <div class="modal-header">
                                    <h1 class="modal-title" id="leaveClubLabel">Leave Club</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body text-start"> Are you sure you want to leave <%=club.name%>? </div>
                                <div class="modal-footer">
                                    <form class="d-inline" action="/bookclubs/<%= club._id%>/leaveclub" method="POST">
                                        <button class="btn primaryBtn active">Confirm</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>
    </div>
    <div class="mt-3">
        <div class="club-header">
            <img src="<%= club.picture.url %>" class="rounded-circle img-fluid profile-picture mx-auto" alt="...">
        </div>
        <div class="ms-3 club-header align-middle">
            <h3>
                <%= club.name%>
            </h3>
            <h5 class="card-text">Admin: <%= club.admin.username%>
            </h5>
        </div>
        <h6 class="mt-5">Description:</h6>
        <p class="club-text mb-5">
            <%= club.description%>
        </p>
    </div>
    <div class="miniNav-header">
        <button class="miniNav active" id="currentTab" onclick="showCurrent()">Current</button>
        <button class="miniNav" id="archiveTab" onclick="showArchived()">Archive</button>
        <% if( currentUser && club.admin.equals(currentUser._id)) { %>
            <button class="miniNav" id="membersTab" onclick="showMembers()">Members</button>
            <% } %>
    </div>
    <section id="current" style="display: block;">
        <% if( currentUser && club.admin.equals(currentUser._id)) { %>
            <div class="my-5">
                <form class="d-flex search" id="searchForm" action="/bookclubs/<%=club._id%>/search" method="POST">
                    <input class="form-control search" autocomplete=off type="text" name="search" required id="searchTerm" placeholder="Find Book...">
                    <select class="search" autocomplete=off name="select" required id="searchCategory">
                        <option>title</option>
                        <option>author</option>
                        <option>publisher</option>
                        <option>category</option>
                    </select>
                    <button class="btn search" type="submit"><i class="bi bi-search"></i></button>
                </form>
            </div>
            <% } %>
                <% if (club.books[0]) { %>
                    <div class="row pt-3">
                        <div class=" col-3 col-md-2">
                            <img src="<%= club.books[0].image%>" class="card-img-top" alt="...">
                        </div>
                        <div class="col-9 col-md-10">
                            <h3 class="card-title">
                                <%= club.books[0].title%>
                            </h3>
                            <h5 class="mb-2">Author: <%= club.books[0].author%>
                            </h5>
                        </div>
                    </div>
                    <div class="card-footer">
                        <h6 class="d-inline ">
                            <%= club.books[0].createdAt.getDate() %>/<%= club.books[0].createdAt.getMonth() + 1 %>/<%= club.books[0].createdAt.getFullYear() %>
                        </h6>
                    </div>
                    <div class="sticky-top comment">
                        <div class="row mb-3 gx-0">
                            <div class="col-2 col-md-1 pt-2">
                                <img src="<%= currentUser.profilePicture.url %>" class="rounded-circle img-fluid comment-profile-picture d-inline mx-auto" alt="...">
                            </div>
                            <div class="col-10 col-md-11 p-2">
                                <form action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments" method="POST" class="validated-form" novalidate>
                                    <div class="mb-2">
                                        <textarea class="form-control comment-form" name="comment[body]" id="body" cols="30" rows="3" placeholder="Leave a comment..." required></textarea>
                                        <div class="valid-feedback"> Looks good! </div>
                                    </div>
                                    <div class="d-inline my-0">
                                        <h5 class="d-inline" style="vertical-align: top;">Rating:</h5>
                                        <fieldset class="starability-basic d-inline" style="vertical-align: bottom;">
                                            <input type="radio" id="no-rate" class="input-no-rate" name="comment[rating]" value="0" checked aria-label="No rating." />
                                            <input type="radio" id="first-rate1" name="comment[rating]" value="1" />
                                            <label for="first-rate1" title="Terrible">1 star</label>
                                            <input type="radio" id="first-rate2" name="comment[rating]" value="2" />
                                            <label for="first-rate2" title="Not good">2 stars</label>
                                            <input type="radio" id="first-rate3" name="comment[rating]" value="3" />
                                            <label for="first-rate3" title="Average">3 stars</label>
                                            <input type="radio" id="first-rate4" name="comment[rating]" value="4" />
                                            <label for="first-rate4" title="Very good">4 stars</label>
                                            <input type="radio" id="first-rate5" name="comment[rating]" value="5" />
                                            <label for="first-rate5" title="Amazing">5 stars</label>
                                        </fieldset>
                                    </div>
                                    <button class="btn secondaryBtn active" style="float: right;">Post</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <% for (let comment of club.books[0].comments) {%>
                        <div id="<%= comment._id %>" name="<%= comment._id %>">
                            <div class="row pb-2 mb-3 gx-0">
                                <div class="col-2 col-md-1">
                                    <img src="<%= comment.author.profilePicture.url %>" class="rounded-circle img-fluid comment-profile-picture d-inline mx-auto" alt="...">
                                </div>
                                <div class="col-10 col-md-11 p-2 comment-bg">
                                    <h5 class="d-inline">
                                        <%= comment.author.username %>
                                    </h5>
                                    <p class="my-2" style="word-wrap: break-word;">
                                        <%= comment.body%>
                                    </p>
                                    <p class="starability-result" data-rating="<%= comment.rating%>"> Rated: <%= comment.rating%> stars </p>
                                    <hr class="mb-1">
                                    <% const timeDiff=currentDate - comment.createdAt; if(timeDiff>52*7*24*60*60e3){ %> <p class="d-inline border-end">
                                            <%= Math.floor(timeDiff / (52*7*24*60*60e3))%>y
                                        </p>
                                        <% } else if(timeDiff>30*24*60*60e3 && timeDiff<52*7*24*60*60e3){ %>
                                                <p class="d-inline border-end">
                                                    <%= Math.floor(timeDiff / (30*24*60*60e3))%>m
                                                </p>
                                                <% } else if(timeDiff>7*24*60*60e3 && timeDiff<30*24*60*60e3){ %>
                                                        <p class="d-inline border-end">
                                                            <%= Math.floor(timeDiff / (7*24*60*60e3))%>w
                                                        </p>
                                                        <% } else if(timeDiff>24*60*60e3 && timeDiff<7*24*60*60e3){ %>
                                                                <p class="d-inline border-end">
                                                                    <%= Math.floor(timeDiff / (24*60*60e3))%>d
                                                                </p>
                                                                <% } else if (timeDiff>60*60e3 && timeDiff<24*60*60e3){ %>
                                                                        <p class="d-inline border-end">
                                                                            <%= Math.floor(timeDiff / (60*60e3))%>h
                                                                        </p>
                                                                        <% } else if (timeDiff> 60e3 && timeDiff<60*60e3) { %>
                                                                                <p class="d-inline border-end">
                                                                                    <%= Math.floor(timeDiff / 60e3)%>m
                                                                                </p>
                                                                                <% } else { %>
                                                                                    <p class="d-inline border-end">
                                                                                        <%= Math.floor(timeDiff / 1e3) %>s
                                                                                    </p>
                                                                                    <% } %>
                                                                                        <% if(comment.replies.length) { %>
                                                                                            <p class="d-inline">
                                                                                                <a class="comment-footer" data-bs-toggle="collapse" href="#comment<%= comment._id %>" role="button" aria-expanded="false" aria-controls="comment<%= comment._id %>">
                                                                                                    <%= comment.replies.length %> replies
                                                                                                </a>
                                                                                            </p>
                                                                                            <% } else if (comment.replies.length===0){ %>
                                                                                                <p class="d-inline ps-1">0 replies </p>
                                                                                                <% } %>
                                                                                                    <p class="d-inline ps-3">
                                                                                                        <a class="comment-footer" data-bs-toggle="collapse" href="#replyTo<%= comment._id %>" role="button" aria-expanded="false" aria-controls="replyTo<%= comment._id %>"> reply </a>
                                                                                                    </p>
                                                                                                    <% if(( currentUser && comment.author.equals(currentUser._id)) ) { %>
                                                                                                        <p class="d-inline ps-3">
                                                                                                            <!-- Button trigger modal -->
                                                                                                            <a class="comment-footer" data-bs-toggle="modal" role="button" data-bs-target="#edit<%= comment._id %>"> edit </a>
                                                                                                        </p>
                                                                                                        <% } if(( currentUser && comment.author.equals(currentUser._id)) || ( currentUser && club.admin.equals(currentUser._id)) ) { %>
                                                                                                            <p class="d-inline ps-3">
                                                                                                                <!-- Button trigger modal -->
                                                                                                                <a class="comment-footer" data-bs-toggle="modal" role="button" data-bs-target="#delete<%= comment._id %>"> delete </a>
                                                                                                            </p>
                                                                                                            <% } %>
                                                                                                                <div class="row justify-content-center">
                                                                                                                    <div class="col-10 px-0">
                                                                                                                        <div class="collapse" id="replyTo<%= comment._id %>">
                                                                                                                            <form action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments/<%= comment._id%>" method="POST" class="mb-3 validated-form" novalidate>
                                                                                                                                <div class="mt-3 mb-2">
                                                                                                                                    <input type="hidden" name="reply[comment]" value="<%= comment._id %>">
                                                                                                                                    <textarea class="form-control reply" name="reply[body]" id="body" cols="30" rows="3" placeholder="Reply..." required></textarea>
                                                                                                                                    <div class="valid-feedback"> Looks good! </div>
                                                                                                                                </div>
                                                                                                                                <button class="btn secondaryBtn active float-end">Submit</button>
                                                                                                                            </form>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                                <div class="collapse" id="comment<%= comment._id %>">
                                                                                                                    <div class="my-3">
                                                                                                                        <% for (let reply of comment.replies){ %>
                                                                                                                            <div class="row">
                                                                                                                                <div class="col-2 col-md-1 ps-0">
                                                                                                                                    <img src="<%= comment.author.profilePicture.url %>" class="rounded-circle img-fluid comment-profile-picture d-inline mx-auto" alt="...">
                                                                                                                                </div>
                                                                                                                                <div class="col-9 col-md-10 p-2 mb-3 replies">
                                                                                                                                    <div class="col">
                                                                                                                                        <h5 class="mb-2">
                                                                                                                                            <%= reply.author.username %>
                                                                                                                                        </h5>
                                                                                                                                        <p style="word-wrap: break-word;">
                                                                                                                                            <%= reply.body%>
                                                                                                                                        </p>
                                                                                                                                        <hr class="mb-1">
                                                                                                                                        <% if(( currentUser && reply.author.equals(currentUser._id)) ) { %>
                                                                                                                                            <p class="d-inline">
                                                                                                                                                <!-- Button trigger modal -->
                                                                                                                                                <a class="comment-footer" data-bs-toggle="modal" role="button" data-bs-target="#edit<%= reply._id %>"> edit </a>
                                                                                                                                            </p>
                                                                                                                                            <% } if(( currentUser && reply.author.equals(currentUser._id)) || ( currentUser && club.admin.equals(currentUser._id)) ) { %>
                                                                                                                                                <p class="d-inline ps-3">
                                                                                                                                                    <!-- Button trigger modal -->
                                                                                                                                                    <a class="comment-footer" data-bs-toggle="modal" role="button" data-bs-target="#delete<%= reply._id %>"> delete </a>
                                                                                                                                                </p>
                                                                                                                                                <% } %>
                                                                                                                                    </div>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                            <div class="modal fade" id="edit<%= reply._id %>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="edit<%= reply._id %>Label" aria-hidden="true">
                                                                                                                                <div class="modal-dialog">
                                                                                                                                    <div class="modal-content club">
                                                                                                                                        <div class="modal-header">
                                                                                                                                            <h1 class="modal-title" id="edit<%= reply._id %>Label">Edit Reply</h1>
                                                                                                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                                                                        </div>
                                                                                                                                        <div class="modal-body">
                                                                                                                                            <form action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments/<%=comment._id%>/reply/<%= reply._id%>?_method=PUT" method="POST" class="mb-3 validated-form" novalidate>
                                                                                                                                                <div class="mb-3">
                                                                                                                                                    <label class="form-label" for="edit-body">Update Reply</label>
                                                                                                                                                    <textarea type="text" class="form-control" id="edit-body" name="reply[body]" cols="30" rows="3" required><%= reply.body%></textarea>
                                                                                                                                                    <div class="valid-feedback">Looks good!</div>
                                                                                                                                                </div>
                                                                                                                                        </div>
                                                                                                                                        <div class="modal-footer">
                                                                                                                                            <button class="btn primaryBtn active">Save Changes</button>
                                                                                                                                            </form>
                                                                                                                                        </div>
                                                                                                                                    </div>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                            <div class="modal fade" id="delete<%= reply._id %>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="delete<%= reply._id %>Label" aria-hidden="true">
                                                                                                                                <div class="modal-dialog">
                                                                                                                                    <div class="modal-content club">
                                                                                                                                        <div class="modal-header">
                                                                                                                                            <h1 class="modal-title" id="delete<%= reply._id %>Label">Delete Reply</h1>
                                                                                                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                                                                        </div>
                                                                                                                                        <div class="modal-body"> Are you sure you want to delete this reply? </div>
                                                                                                                                        <div class="modal-footer">
                                                                                                                                            <form class="d-inline" action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments/<%=comment._id%>/reply/<%= reply._id%>?_method=DELETE" method="POST">
                                                                                                                                                <button class="btn primaryBtn active">Delete <i class="bi bi-trash3"></i></button>
                                                                                                                                            </form>
                                                                                                                                        </div>
                                                                                                                                    </div>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                            <% } %>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                                <% if(( currentUser && comment.author.equals(currentUser._id)) ) { %>
                                                                                                                    <div class="modal fade" id="edit<%= comment._id %>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="edit<%= comment._id %>Label" aria-hidden="true">
                                                                                                                        <div class="modal-dialog">
                                                                                                                            <div class="modal-content club">
                                                                                                                                <div class="modal-header">
                                                                                                                                    <h1 class="modal-title" id="edit<%= comment._id %>Label">Edit Comment</h1>
                                                                                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                                                                </div>
                                                                                                                                <div class="modal-body">
                                                                                                                                    <form action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments/<%= comment._id%>?_method=PUT" method="POST" class="mb-3 validated-form" novalidate>
                                                                                                                                        <div class="mb-3">
                                                                                                                                            <fieldset class="starability-basic">
                                                                                                                                                <legend> Rating: </legend>
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-no-rate" class="input-no-rate" name="comment[rating]" value="0" checked aria-label="No rating." />
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-first-rate1" name="comment[rating]" value="1" />
                                                                                                                                                <label for="<%= comment._id%>-edit-first-rate1" title="Terrible">1 star</label>
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-first-rate2" name="comment[rating]" value="2" />
                                                                                                                                                <label for="<%= comment._id%>-edit-first-rate2" title="Not good">2 stars</label>
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-first-rate3" name="comment[rating]" value="3" />
                                                                                                                                                <label for="<%= comment._id%>-edit-first-rate3" title="Average">3 stars</label>
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-first-rate4" name="comment[rating]" value="4" />
                                                                                                                                                <label for="<%= comment._id%>-edit-first-rate4" title="Very good">4 stars</label>
                                                                                                                                                <input type="radio" id="<%= comment._id%>-edit-first-rate5" name="comment[rating]" value="5" />
                                                                                                                                                <label for="<%= comment._id%>-edit-first-rate5" title="Amazing">5 stars</label>
                                                                                                                                            </fieldset>
                                                                                                                                        </div>
                                                                                                                                        <div class="mb-3">
                                                                                                                                            <label class="form-label" for="edit-body">Update Comment</label>
                                                                                                                                            <textarea type="text" class="form-control" id="edit-body" name="comment[body]" cols="30" rows="3" required><%= comment.body%></textarea>
                                                                                                                                            <div class="valid-feedback">Looks good!</div>
                                                                                                                                        </div>
                                                                                                                                </div>
                                                                                                                                <div class="modal-footer">
                                                                                                                                    <button class="btn primaryBtn active">Save Changes</button>
                                                                                                                                    </form>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="modal fade" id="delete<%= comment._id %>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="delete<%= comment._id %>Label" aria-hidden="true">
                                                                                                                        <div class="modal-dialog">
                                                                                                                            <div class="modal-content club">
                                                                                                                                <div class="modal-header">
                                                                                                                                    <h1 class="modal-title" id="delete<%= comment._id %>Label"> Delete Comment</h1>
                                                                                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                                                                </div>
                                                                                                                                <div class="modal-body"> Are you sure you want to delete this comment? </div>
                                                                                                                                <div class="modal-footer">
                                                                                                                                    <form class="d-inline" action="/bookclubs/<%= club._id%>/books/<%= club.books[0]._id%>/comments/<%= comment._id%>?_method=DELETE" method="POST">
                                                                                                                                        <button class="btn primaryBtn active">Delete <i class="bi bi-trash3"></i></button>
                                                                                                                                    </form>
                                                                                                                                </div>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <% } %>
                                </div>
                            </div>
                        </div>
                        <% }%>
                            <% } %>
    </section>
    <section id="archived" style="display: none;">
        <% for( let i=1; i < club.books.length; i++) { %>
            <div class=" gx-0 mt-3 club">
                <a class="d-inline px-0" href="/bookclubs/<%= club._id%>/books/<%= club.books[i]._id%>">
                    <div class="row gx-0">
                        <div class=" col-3 col-md-2">
                            <img src="<%= club.books[i].image%>" class="card-img-top" alt="...">
                        </div>
                        <div class="col-9 col-md-10 pt-2 px-2">
                            <h3 class="card-title">
                                <%= club.books[i].title%>
                            </h3>
                            <h5 class="mb-2">Author: <%= club.books[i].author%>
                            </h5>
                            <% if (club.books[i].comments[club.books[i].comments.length - 1]){ %>
                                <div class="d-none d-lg-block">
                                    <h5 class="empty">Latest Comment</h5>
                                    <p class="text-truncate-5 empty">
                                        <%= club.books[i].comments[club.books[i].comments.length - 1].author.username %> : <%=club.books[i].comments[club.books[i].comments.length - 1].body %>
                                    </p>
                                </div>
                                <% } else { %>
                                    <h5>No Comments Yet</h5>
                                    <% } %>
                        </div>
                    </div>
                </a>
                <div class="card-footer pb-3">
                    <h6 class="d-inline align-bottom">
                        <%= club.books[i].createdAt.getDate() %>/<%= club.books[i].createdAt.getMonth() + 1 %>/<%= club.books[i].createdAt.getFullYear() %>
                    </h6>
                    <!-- Button trigger modal -->
                    <% if( currentUser && club.admin.equals(currentUser._id)) { %>
                        <button type="button" class="btn btn-sm primaryBtn float-end" data-bs-toggle="modal" data-bs-target="#delete<%= club.books[i]._id %>">
                            <i class="bi bi-trash3"></i> Delete </button>
                </div>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="delete<%= club.books[i]._id %>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="delete<%= club.books[i]._id %>Label" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title" id="delete<%= club.books[i]._id %>"> Delete Book </h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body"> Are you sure you want to delete this book? </div>
                        <div class="modal-footer">
                            <form class="d-inline" action="/bookclubs/<%= club._id%>/books/<%= club.books[i]._id%>?_method=DELETE" method="POST">
                                <button class="btn primaryBtn active"><i class="bi bi-trash3"></i> Delete</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <% } %>
                </div>
                </div>
                <% } %>
                    <hr>
    </section>
    <section id="members" style="display: none;">
        <div class="my-5">
            <form class="d-flex search" action="/bookclubs/<%=club._id%>/usersearch" method="POST">
                <input class="form-control search" autocomplete=off type="text" id="usersearch" name="usersearch" placeholder="Add Members...">
                <button class="btn search"><i class="bi bi-search"></i></button>
            </form>
        </div>
        <div class="" id="infinite-scroll">
            <div class="container friends">
                <h2 class="mt-3 mb-0">Friends</h2>
                <hr class="mt-1">
                <% for (let user of club.members) {%>
                    <div class="d-flex mb-3">
                        <div class="me-auto">
                            <div class="d-inline-block align-middle">
                                <img src="<%= user.profilePicture.url %>" class="rounded-circle img-fluid friend-profile-picture d-inline me-3" alt="...">
                            </div>
                            <div class="d-inline-block align-middle">
                                <h5 class="card-title text-truncate py-0 my-0" style="max-width: 170px; border: none;">
                                    <%= user.username%>
                                </h5>
                                <!-- <h6 class="pb-0 mb-0"></h6> -->
                            </div>
                        </div>
                        <div class="ms-auto">
                            <button type="button" class="btn primaryBtn" data-bs-toggle="modal" data-bs-target="#remove<%=user._id%>">
                                <!-- Button trigger modal -->
                                <i class="bi bi-trash3"></i> Remove
                            </button>
                        </div>
                        <!-- Modal -->
                        <div class="modal fade" id="remove<%=user._id%>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="remove<%=user._id%>Label" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content club">
                                    <div class="modal-header">
                                        <h1 class="modal-title" id="remove<%=user._id%>Label">Remove Member</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body text-start"> Are you sure you want to remove <%=user.username%> as a member of <%=club.name%>? </div>
                                    <div class="modal-footer">
                                        <form class="d-inline" action="/bookclubs/<%= club._id%>/removeuser" method="POST">
                                            <input type="text" name="userId" id="userId" value="<%=user._id%>" hidden>
                                            <button class="btn primaryBtn active" type="submit"><i class="bi bi-trash3"></i> Remove</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <% } %>
            </div>
        </div>
    </section>
    <script type="text/javascript" src="/javascripts/miniNav.js"></script>